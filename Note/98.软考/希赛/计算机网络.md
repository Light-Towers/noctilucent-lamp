一个标准的URL格式如下：
协议://主机名.域名.域名后缀或IP地址(:端口号)/目录/文件名。

---

# 路由配置
## 路由协议
路由协议是用于确定数据包传输路径的网络层协议，通过动态维护路由表，实现网络节点间的智能路径选择。
根据作用范围分为内部网关协议（IGP）和外部网关协议（EGP），核心功能是动态路由选择与网络路径优化。
路由器之间可以通过路由协议学习网络的拓扑结构。

### **一、静态路由 vs 动态路由**
| **类型**       | **配置方式**         | **适用场景**       | **优缺点**                   |
|----------------|----------------------|--------------------|-----------------------------|
| **静态路由**   | 手动配置固定路径     | 小型网络、拓扑稳定 | 简单安全，但无法适应网络变化 |
| **动态路由**   | 自动学习并更新路径   | 中大型复杂网络     | 自适应性强，需协议开销       |

动态路由协议又分为距离矢量路由协议和链路状态路由协议。


### 二、内部网关协议(Interior GatewayProtocol，IGP)
* 用于在单一自治系统(Autonomous System,AS)内决策路由，是对链路状态路由协议的一种实现。

#### **1. 距离矢量路由协议**
- **原理**：通过定期广播整个路由表，基于跳数或成本计算最优路径。
- **特点**：简单易部署，但收敛慢、易产生环路。
- **常见协议**：
  - **RIP（Routing Information Protocol，路由信息协议）**  
    - 版本：RIPv1（无类）、RIPv2（支持VLSM/CIDR）  
    - 最大跳数：15，适用于小型网络。
    - 更新周期：30秒，通过UDP 520端口通信。

  - **EIGRP（增强型内部网关路由协议）**  
    - Cisco私有协议，结合距离矢量和链路状态特性。
    - 使用DUAL算法快速收敛，支持多协议（IPv4/IPv6）。

#### **2. 链路状态路由协议**
- **原理**：泛洪链路状态信息（LSA），构建拓扑数据库后通过SPF算法计算最短路径。
- **特点**：收敛快、拓扑透明，但资源消耗较高。
- **常见协议**：
  - **OSPF（Open Shortest Path First，开放式最短路径优先）**  
    - 版本：OSPFv2（IPv4）、OSPFv3（IPv6）。  
    - 分层设计（Area 0为骨干区域），支持认证和负载均衡。  
    - 适用中大型企业网络，通过IP协议号89通信。

  - **IS-IS（中间系统到中间系统）**  
    - 最初为OSI模型设计，后扩展支持IP。  
    - 广泛用于ISP骨干网，采用两级分层（Level 1/2）。

### **三、外部网关协议（EGP）**
用于不同自治系统（AS）间的路由交互，核心协议为：

#### **BGP（边界网关协议）**
BGP:边界网关协议是运行于TCP 上的一种自治系统的外部网关协议。 BGP 是唯一一个用来处理像因特网大小的网络的协议，也是唯一能够妥善处理好不相关路由域间的多路连接的协议。
- **版本**：BGP-4（支持CIDR和路由聚合）。
- **特点**：
  - 基于路径矢量算法，通过AS_Path属性防环。
  - 使用TCP 179端口，支持增量更新和策略路由。
  - 适用于互联网核心层，实现跨AS的路由控制。
- **类型**：
  - **eBGP**：运行于不同AS间，默认TTL=1。
  - **iBGP**：同一AS内BGP路由器通信，需全互联或路由反射器。

### **四、动态路由协议工作原理**
1. **邻居发现**：路由器通过组播（如OSPF）或广播（RIP）发现相邻节点。
2. **信息交换**：
   - 距离矢量：定期发送整个路由表。
   - 链路状态：洪泛本地链路状态，构建统一拓扑数据库。
3. **路由计算**：
   - RIP：贝尔曼-福特算法（Bellman-Ford）。
   - OSPF：Dijkstra最短路径算法。
   - BGP：基于策略的属性比较。
4. **路由表更新**：将最优路径写入路由表，并向下游节点传播。

### **五、关键协议对比**
| **协议** | **类型**       | **算法**        | **度量标准**       | **收敛速度** | **适用规模** |
|----------|----------------|-----------------|--------------------|--------------|--------------|
| RIP      | 距离矢量       | Bellman-Ford    | 跳数               | 慢           | 小型网络     |
| OSPF     | 链路状态       | Dijkstra SPF    | 带宽（Cost值）     | 快           | 中大型网络   |
| BGP      | 路径矢量       | 路径属性择优    | AS路径、策略       | 慢（策略驱动）| 跨AS互联     |


### **六、优化总结**
- **协议选型**：根据网络规模选择IGP（小型用RIP，大型用OSPF/IS-IS），跨AS必用BGP。
- **资源权衡**：链路状态协议需更高CPU/内存，距离矢量适合低资源环境。
- **安全性**：启用OSPF MD5认证、BGP TTL Security等机制。
- **扩展性**：采用分层设计（如OSPF多区域、BGP路由聚合）减少路由表规模。


---

# 协议基础

![网络协议-层级对应关系](https://raw.githubusercontent.com/Light-Towers/picture/master/noctilucent-lamp/网络协议-层级对应关系.png)

基于TCP的应用层协议：FTP、Telnet、SMTP、HTTP、POP3与DNS
基于UDP的应用层协议：DHCP、TFTP、SNMP与DNS
其中DNS既可以基于TCP，也可以基于UDP。**技巧：只记住UDP的两个，其余全是基于TCP即可。(DNS两个都是)**



### TCP

TCP(Transmission Control Protocol，传输控制协议)使用**序列号（基于字节）**来确保数据的可靠传输。当TCP发送数据段(segments)时，它会为每个数据段分配一个唯一的序列号。TCP使用**序列号标识数据段的位置**，并允许接收端在检测到丢失或乱序的数据段时请求重传。

比特(bit)是信息量的基本单位。

报文(message)是TCP/IP网络中传输的信息单位，但TCP的序列号是基于每个数据段中的字节的，而不是整个报文。

在TCP/IP网络中，建立连接进行可靠通信描述的是TCP协议，属于传输层协议。在OSI/RM七层模型中，传输层以上还有会话层、表示层、应用层，传输层以下是网络层。数据链路层在物理层提供的服务的基础上向网络层提供服务，其最基本的服务是将源自物理层来的数据可靠地传输到相邻节点的目标机网络层
应用层主要实现具体的应用功能。
表示层主要处理数据的格式与表达、加密、压缩。
会话层为表示层提供建立、维护和结束会话连接的功能，并提供会话管理服务，也就是说会话层可以建立连接，第空选择会话层。
网络层为传输层的数据传输提供建立、维护和终止网络连接的手段，这里针对的是网络连接，与可靠性连接无关。



---

# OSI七层网络参考模型

OSI（开放系统互连）七层模型是网络通信的标准化框架，将通信过程分为七个层次，每层负责特定的功能。

### **1. 物理层（Physical Layer）**
- **功能**：负责**建立和管理物理连接，传输原始比特流（0和1）**，并通过传输介质为数据链路层提供可靠的物理传输通道，同时**监控数据传输中的错误率**，确保数据流的**透明传输**。
- **关键设备**：网卡、集线器、中继器、电缆、光纤。
- **协议/标准**：IEEE 802.3（以太网）、RS-232、USB。
- **数据单元**：比特（Bit）。

### **2. 数据链路层（Data Link Layer）**
- **功能**：将在物理层上传输的**比特流封装成帧**，**通过MAC地址在局域网内传输**，并提供**错误检测（如CRC校验）、差错控制和流量控制**，确保在不可靠物理线路上实现可靠的数据传输。
- **关键设备**：交换机、网桥。
- **协议**：以太网（Ethernet）、PPP、HDLC、ARP（地址解析协议）。
  - ARP（地址解析协议）：IP地址解析为MAC地址。请求是广播发送，响应是单播发送。
  - RARP（反地址解析协议）：MAC地址转换成IP地址
- **数据单元**：帧（Frame）。

### **3. 网络层（Network Layer）**
- **功能**：通过IP地址实现不同网络间的路由选择与数据包转发，在节点间创建逻辑链路以传输数据，利用路由选择算法为分组在通信子网中选择最优路径，并支持拥塞控制和网络互联等功能。
- **关键设备**：路由器。
- **协议**：IP、ICMP（如ping命令）、OSPF、BGP。
  - ICMP：网络层协议，用于传递控制消息（如网络不可达）。
- **数据单元**：数据包（Packet）。

### **4. 传输层（Transport Layer）**
- **功能**：提供端到端的可靠或不可靠传输，管理流量控制和错误恢复。
- **协议**：TCP（可靠，面向连接）、UDP（不可靠，无连接）。
- **关键概念**：端口号（如HTTP:80、HTTPS:443）。
- **数据单元**：段（Segment，TCP）/数据报（Datagram，UDP）。

### **5. 会话层（Session Layer）**
- **功能**：建立、管理和终止会话（如断点续传、身份验证）。
- **协议**：NetBIOS、RPC、SSH（部分功能）。
- **实际应用**：较少独立实现，常被合并到传输层或应用层。

### **6. 表示层（Presentation Layer）**
- **功能**：数据格式转换、加密/解密、压缩/解压缩。
- **协议/技术**：SSL/TLS（加密）、JPEG、ASCII、MPEG。
  - SSL/TLS：通常位于OSI的表示层，但在TCP/IP模型中视为应用层与传输层之间的安全层。
- **示例**：HTTPS的加密由SSL/TLS在表示层处理。

### **7. 应用层（Application Layer）**
- **功能**：为用户应用程序提供网络服务接口，实现具体的网络应用功能。
- **协议**：HTTP、FTP、SMTP、DNS、DHCP。
  - SMTP：邮件传输协议，用于发送邮件。传输的邮件报文采用ASCII编码。
- **示例**：浏览器通过HTTP协议访问网页。

### **关键总结**
- **数据封装流程**：  
  应用层数据 → 传输层加TCP/UDP头 → 网络层加IP头 → 数据链路层加帧头/尾 → 物理层转为比特流。
- **设备与层次对应**：  
  集线器（物理层）→ 交换机（数据链路层）→ 路由器（网络层）→ 网关（高层协议转换）。
- **TCP/IP模型对比**：  
  OSI的会话层、表示层、应用层合并为TCP/IP的**应用层**；OSI的数据链路层和物理层对应TCP/IP的**网络接口层**。




IPv4: 32位地址，IPv6: 128 位地址。IPv6地址空间是IPv4的2^96^倍。

采用DHCP动态分配IP地址，如果某主机开机后没有得到DHCP服务器的响应。则主机获取的IP地址属于网络169.254.0.0/16


**MIME**:MIME(Multipurpose Intemnet Mai Extensions)即多用途互联网邮件扩展类型。是设定某种扩展名的文件用种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。它是一个互联网标准，扩展了电子邮件标准，使其能够支持多媒体格式。
**SMTP**:邮件传输协议。SMTP的全称是"Simple Mai Transfer Protocol"，即简单邮件传输协议。它是一组用于从源地址到目的地址传输邮件的规范，通过它来控制邮件的中转方式。SMTP 协议属于TCP/IP 协议簇，它帮助每台计算机在发送或中转信件时找到下一个目的地。SMTP 服务器就是遵循 SMTP 协议的发送邮件服务器。SMTP是个相对简单的基于文本的协议，无法处理多媒体数据。
**POP3**:邮件收取协议。POP3是Post Ofice Protocol3的简称，即邮局协议的第3个版本,它规定怎样将个人计算机连接到Intemet的邮件服务器和下载电子邮件的电子协议。它是因特网电子邮件的第一个离线协议标准,POP3允许用户从服务器上把邮件存储到本地主机(即自己的计算机)上,同时删除保存在邮件服务器上的邮件，而POP3服务器则是遵循POP3协议的接收邮件服务器，用来接收电子邮件的。
**IMAP4**:IMAP4(Intemet Message Access Protocol 4)即 交互式数据消息访问协议第四个版本。IMAP4协议与POP3协议一样也是规定个人计算机如何访问网上的邮件的服务器进行收发邮件的协议，但是IMAP4协议同POP3协议相比更高级。IMAP4支持协议客户机在线或者离开访问并阅读服务器上的邮件，还能交互式的操作服务器上的邮件。IMAP4协议更人性化的地方是不雲要像POP3协议那样把邮件下载到本地，用户可以通过客户端直接对服务器上的邮件进行操作(这里的操作是指:在线阅读邮件、在线查看邮件主题及大小、发件地址等信息)。用户还可以在服务器上维护自己邮件目录(维护是指移动，如新建、删除、重命名、共享、抓取文本等操作)。


HTTP一次请求过程：
在浏览器中输入URL，并按下回车键;
浏览器向DNS服务器发出域名解析请求并获得结果;
根据目的IP地址和端口号，与服务器建立TCP;
连接浏览器向服务器发送数据请求;
服务器将网页数据发送给浏览器;
通信完成，断开TCP连接;
浏览器解析收到的数据并显示


### 网络命令相关

- **netstat**  
  - 是监控TCP/IP网络的工具。  
  - 可以显示路由表、网络连接和接口设备状态信息。  
  - 显示与IP、TCP、UDP和ICMP相关的统计数据。  
  - 一般用于检验本机各端口的网络连接情况。

- **nslookup**  
  - 监测DNS服务器是否能正确实现域名解析。  

- **ping**  
  - 常用于测试网络连通性。  
  - 可以直接ping目标地址。

- **tracert**  
  - 路由跟踪实用程序。  
  - 用于确定IP数据包访问目标所采取的路径。

- **命令与DNS关联**  
  - nslookup、ping、tracert可以加上主机域名作为参数诊断DNS故障。  
  - nslookup可以看到本地DNS服务器地址。  
  - netstat与DNS无关联。

ADSLModem上网拨号方式有3种，即专线方式(静态IP)、PPPoA和PPPoE。
PPPoE(英语:Point-to-Point ProtocolOver Ethernet)，以太网上的点对点协议，是将点对点协议(PPP)封装在以太网(Ethernet)框架中的一种网络隧道协议。
PPTP(Point-to-Point Tunneling Protocol)，即点对点隧道协议。该协议是在PPP协议的基础上开发的一种新的增强型安全协议，支持多协议虚拟专用网(VPN)，可以通过密码验证协议(PAP)、可扩展认证协议(EAP)等方法增强安全性。可以使远程用户通过拨入ISP、通过直接连接Internet或其他网络安全地访问企业网。
SLIP(Serial Line nternet Protocol，串行线路网际协议)，该协议是Windows远程访问的一种旧工业标准，主要在Unix远程访问服务器中使用，现今仍然用于连接某些ISP.
PPP(点到点协议)是为在同等单元之间传输数据包这样的简单链路设计的链路层协议。这种链路提供全双工操并按照顺序传递数据包。设计目的主要是用来通过拨号或专线方式建立点对点连接发送数据，使其成为各种主作，机、网杯和路由器之间简单连接的一种共通的解决方案。

