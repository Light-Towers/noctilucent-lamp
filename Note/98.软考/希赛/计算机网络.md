一个标准的URL格式如下：
协议://主机名.域名.域名后缀或IP地址(:端口号)/目录/文件名。

---

# 路由配置
## 路由协议
路由协议是用于确定数据包传输路径的网络层协议，通过动态维护路由表，实现网络节点间的智能路径选择。
根据作用范围分为内部网关协议（IGP）和外部网关协议（EGP），核心功能是动态路由选择与网络路径优化。
路由器之间可以通过路由协议学习网络的拓扑结构。

### **一、静态路由 vs 动态路由**
| **类型**       | **配置方式**         | **适用场景**       | **优缺点**                   |
|----------------|----------------------|--------------------|-----------------------------|
| **静态路由**   | 手动配置固定路径     | 小型网络、拓扑稳定 | 简单安全，但无法适应网络变化 |
| **动态路由**   | 自动学习并更新路径   | 中大型复杂网络     | 自适应性强，需协议开销       |

动态路由协议又分为距离矢量路由协议和链路状态路由协议。


### 二、内部网关协议(Interior GatewayProtocol，IGP)
* 用于在单一自治系统(Autonomous System,AS)内决策路由，是对链路状态路由协议的一种实现。

#### **1. 距离矢量路由协议**
- **原理**：通过定期广播整个路由表，基于跳数或成本计算最优路径。
- **特点**：简单易部署，但收敛慢、易产生环路。
- **常见协议**：
  - **RIP（Routing Information Protocol，路由信息协议）**  
    - 版本：RIPv1（无类）、RIPv2（支持VLSM/CIDR）  
    - 最大跳数：15，适用于小型网络。
    - 更新周期：30秒，通过UDP 520端口通信。

  - **EIGRP（增强型内部网关路由协议）**  
    - Cisco私有协议，结合距离矢量和链路状态特性。
    - 使用DUAL算法快速收敛，支持多协议（IPv4/IPv6）。

#### **2. 链路状态路由协议**
- **原理**：泛洪链路状态信息（LSA），构建拓扑数据库后通过SPF算法计算最短路径。
- **特点**：收敛快、拓扑透明，但资源消耗较高。
- **常见协议**：
  - **OSPF（Open Shortest Path First，开放式最短路径优先）**  
    - 版本：OSPFv2（IPv4）、OSPFv3（IPv6）。  
    - 分层设计（Area 0为骨干区域），支持认证和负载均衡。  
    - 适用中大型企业网络，通过IP协议号89通信。

  - **IS-IS（中间系统到中间系统）**  
    - 最初为OSI模型设计，后扩展支持IP。  
    - 广泛用于ISP骨干网，采用两级分层（Level 1/2）。

### **三、外部网关协议（EGP）**
用于不同自治系统（AS）间的路由交互，核心协议为：

#### **BGP（边界网关协议）**
BGP:边界网关协议是运行于TCP 上的一种自治系统的外部网关协议。 BGP 是唯一一个用来处理像因特网大小的网络的协议，也是唯一能够妥善处理好不相关路由域间的多路连接的协议。
- **版本**：BGP-4（支持CIDR和路由聚合）。
- **特点**：
  - 基于路径矢量算法，通过AS_Path属性防环。
  - 使用TCP 179端口，支持增量更新和策略路由。
  - 适用于互联网核心层，实现跨AS的路由控制。
- **类型**：
  - **eBGP**：运行于不同AS间，默认TTL=1。
  - **iBGP**：同一AS内BGP路由器通信，需全互联或路由反射器。

### **四、动态路由协议工作原理**
1. **邻居发现**：路由器通过组播（如OSPF）或广播（RIP）发现相邻节点。
2. **信息交换**：
   - 距离矢量：定期发送整个路由表。
   - 链路状态：洪泛本地链路状态，构建统一拓扑数据库。
3. **路由计算**：
   - RIP：贝尔曼-福特算法（Bellman-Ford）。
   - OSPF：Dijkstra最短路径算法。
   - BGP：基于策略的属性比较。
4. **路由表更新**：将最优路径写入路由表，并向下游节点传播。

### **五、关键协议对比**
| **协议** | **类型**       | **算法**        | **度量标准**       | **收敛速度** | **适用规模** |
|----------|----------------|-----------------|--------------------|--------------|--------------|
| RIP      | 距离矢量       | Bellman-Ford    | 跳数               | 慢           | 小型网络     |
| OSPF     | 链路状态       | Dijkstra SPF    | 带宽（Cost值）     | 快           | 中大型网络   |
| BGP      | 路径矢量       | 路径属性择优    | AS路径、策略       | 慢（策略驱动）| 跨AS互联     |


### **六、优化总结**
- **协议选型**：根据网络规模选择IGP（小型用RIP，大型用OSPF/IS-IS），跨AS必用BGP。
- **资源权衡**：链路状态协议需更高CPU/内存，距离矢量适合低资源环境。
- **安全性**：启用OSPF MD5认证、BGP TTL Security等机制。
- **扩展性**：采用分层设计（如OSPF多区域、BGP路由聚合）减少路由表规模。


---

# 协议基础

![网络协议-层级对应关系](https://raw.githubusercontent.com/Light-Towers/picture/master/noctilucent-lamp/网络协议-层级对应关系.png)

基于TCP的应用层协议：FTP、Telnet、SMTP、HTTP、POP3与DNS
基于UDP的应用层协议：DHCP、TFTP、SNMP与DNS
其中DNS既可以基于TCP，也可以基于UDP。**技巧：只记住UDP的两个，其余全是基于TCP即可。(DNS两个都是)**

## OSI 各层主要职责
  - **应用层**：实现具体的应用功能（如 HTTP、FTP）。
  - **表示层**：处理数据格式、加密与压缩。
  - **会话层**：建立、维护和终止会话连接。
  - **传输层**：提供端到端的可靠或不可靠传输（如 TCP、UDP）。
  - **网络层**：实现数据包的路由选择与转发。
  - **数据链路层**：实现局域网内帧的可靠传输。
  - **物理层**：传输比特流(bit, 信息量的基本单位)，定义电气和物理接口。

### TCP

TCP（Transmission Control Protocol，传输控制协议）是一种**面向连接、可靠的字节流协议**，属于传输层协议。其核心机制如下：

- **序列号机制**：
  - TCP 使用**基于字节的序列号**来标识每个数据段中的起始位置。
  - 每个数据段都有一个唯一的序列号，接收方通过该机制检测数据丢失或乱序，并请求重传以保证完整性。

- **可靠传输保障**：
  - 确认应答机制（ACK）：接收方收到数据后发送确认报文。
  - 超时重传机制：若未收到 ACK，则重新发送未被确认的数据段。
  - 流量控制与拥塞控制：防止发送速率超过接收方处理能力或网络承载能力。

- **数据单位说明**：
  - 在 TCP/IP 协议栈中，**“报文”（message）**是应用层传递给传输层的数据单元。
  - TCP 将其拆分为多个 **“段”（segment）** 进行传输，每个段包含一定范围的字节数据及对应的序列号。

- **OSI 模型层级关系**：
  - TCP 属于 OSI/RM 模型中的**传输层**，负责端到端通信。
  - 传输层之上为**会话层、表示层和应用层**，分别处理会话管理、数据格式转换和具体应用功能。
  - 传输层之下为**网络层**，负责路由选择与数据包转发。
  - 数据链路层在物理层提供的服务基础上向网络层提供服务，确保相邻节点间的数据可靠传输。


---

# OSI七层网络参考模型

OSI（开放系统互连）七层模型是网络通信的标准化框架，将通信过程分为七个层次，每层负责特定的功能。

### **1. 物理层（Physical Layer）**
- **功能**：负责**建立和管理物理连接，传输原始比特流（0和1）**，并通过传输介质为数据链路层提供可靠的物理传输通道，同时**监控数据传输中的错误率**，确保数据流的**透明传输**。
- **关键设备**：网卡、集线器、中继器、电缆、光纤。
- **协议/标准**：IEEE 802.3（以太网）、RS-232、USB。
- **数据单元**：比特（Bit）。

### **2. 数据链路层（Data Link Layer）**
- **功能**：将在物理层上传输的**比特流封装成帧**，**通过MAC地址在局域网内传输**，并提供**错误检测（如CRC校验）、差错控制和流量控制**，确保在不可靠物理线路上实现可靠的数据传输。
- **关键设备**：交换机、网桥。
- **协议**：以太网（Ethernet）、PPP、HDLC、ARP（地址解析协议）。
  - ARP（地址解析协议）：IP地址解析为MAC地址。请求是广播发送，响应是单播发送。
  - RARP（反地址解析协议）：MAC地址转换成IP地址
- **数据单元**：帧（Frame）。

### **3. 网络层（Network Layer）**
- **功能**：通过IP地址实现不同网络间的路由选择与数据包转发，在节点间创建逻辑链路以传输数据，利用路由选择算法为分组在通信子网中选择最优路径，并支持拥塞控制和网络互联等功能。
- **关键设备**：路由器。
- **协议**：IP、ICMP（如ping命令）、OSPF、BGP。
  - ICMP：网络层协议，用于传递控制消息（如网络不可达）。
- **数据单元**：数据包（Packet）。

### **4. 传输层（Transport Layer）**
- **功能**：提供端到端的可靠或不可靠传输，管理流量控制和错误恢复。
- **协议**：TCP（可靠，面向连接）、UDP（不可靠，无连接）。
- **关键概念**：端口号（如HTTP:80、HTTPS:443）。
- **数据单元**：段（Segment，TCP）/数据报（Datagram，UDP）。

### **5. 会话层（Session Layer）**
- **功能**：建立、管理和终止会话（如断点续传、身份验证）。
- **协议**：NetBIOS、RPC、SSH（部分功能）。
- **实际应用**：较少独立实现，常被合并到传输层或应用层。

### **6. 表示层（Presentation Layer）**
- **功能**：数据格式转换、加密/解密、压缩/解压缩。
- **协议/技术**：SSL/TLS（加密）、JPEG、ASCII、MPEG。
  - SSL/TLS：通常位于OSI的表示层，但在TCP/IP模型中视为应用层与传输层之间的安全层。
- **示例**：HTTPS的加密由SSL/TLS在表示层处理。

### **7. 应用层（Application Layer）**
- **功能**：为用户应用程序提供网络服务接口，实现具体的网络应用功能。
- **协议**：HTTP、FTP、SMTP、DNS、DHCP。
  - SMTP：邮件传输协议，用于发送邮件。传输的邮件报文采用ASCII编码。
- **示例**：浏览器通过HTTP协议访问网页。

### **关键总结**
- **数据封装流程**：
  应用层数据 → 传输层加TCP/UDP头 → 网络层加IP头 → 数据链路层加帧头/尾 → 物理层转为比特流。
- **设备与层次对应**：
  集线器（物理层）→ 交换机（数据链路层）→ 路由器（网络层）→ 网关（高层协议转换）。
- **TCP/IP模型对比**：
  OSI的会话层、表示层、应用层合并为TCP/IP的**应用层**；OSI的数据链路层和物理层对应TCP/IP的**网络接口层**。


---
IPv4: 32位地址，IPv6: 128 位地址。IPv6地址空间是IPv4的2^96^倍。

---
# DHCP 与自动配置地址

- **DHCP（Dynamic Host Configuration Protocol）** 是一种用于动态分配 IP 地址和网络配置参数的协议。
- 如果主机开机后未能从 DHCP 服务器获取 IP 地址，则会自动分配一个 **链路本地地址（Link-Local Address）**，范围为 `169.254.0.0/16`。
- 此类地址仅在本地网络段有效，不能用于跨网段通信，常用于局域网内设备间的临时通信。

---

# 常见邮件相关协议

#### **1. MIME（Multipurpose Internet Mail Extensions）**
- **定义**：多用途互联网邮件扩展类型。
- **作用**：
  - 扩展电子邮件标准，使其支持非 ASCII 内容（如图像、音频、视频等多媒体数据）。
  - 指定文件扩展名对应的打开方式，实现浏览器或客户端对特定格式文件的自动识别与处理。
- **应用场景**：网页文件下载、电子邮件附件、API 响应内容类型标识。

#### **2. SMTP（Simple Mail Transfer Protocol）**
- **定义**：简单邮件传输协议。
- **功能**：
  - 负责将邮件从发送方传输到接收方邮件服务器。
  - 控制邮件在网络中的中转路径。
- **特点**：
  - 属于 TCP/IP 协议簇。
  - 基于文本协议，端口号为 `25`（默认），也支持加密版本 `SMTPS`（端口 `465` 或 `587`）。
  - 不支持多媒体内容直接传输，需结合 MIME 使用。

#### **3. POP3（Post Office Protocol Version 3）**
- **定义**：邮局协议第 3 版本。
- **功能**：
  - 允许用户从邮件服务器下载邮件到本地设备。
  - 下载后通常删除服务器上的原始邮件（离线访问模式）。
- **端口**：默认使用 `110`（明文），支持加密版本 `995`（POP3S）。

#### **4. IMAP4（Internet Message Access Protocol Version 4）**
- **定义**：交互式数据消息访问协议第 4 版。
- **功能**：
  - 支持在线访问和管理服务器上的邮件。
  - 用户可在多个设备上同步查看、操作邮件内容（如阅读、移动、删除）。
  - 邮件保留在服务器上，便于集中管理和跨设备访问。
- **端口**：默认使用 `143`（明文），支持加密版本 `993`（IMAPS）。
- **优势**：
  - 比 POP3 更高级，适合需要云端管理邮件的场景。

### **总结对比：邮件协议特性**

| 协议 | 功能 | 是否支持多媒体 | 是否保留服务器副本 | 加密端口 |
|------|------|------------------|----------------------|-----------|
| MIME | 邮件内容扩展 | ✅ | N/A | N/A |
| SMTP | 发送邮件 | ❌（需配合MIME） | 否 | ✅（465/587） |
| POP3 | 接收邮件（下载并删除） | ❌ | ❌ | ✅（995） |
| IMAP4 | 接收邮件（在线管理） | ✅ | ✅ | ✅（993） |

---

# HTTP一次请求过程

1. 在浏览器中输入URL，并按下回车键;
2. 浏览器向DNS服务器发出域名解析请求并获得结果;
3. 根据目的IP地址和端口号，与服务器建立TCP;
4. 连接浏览器向服务器发送数据请求;
5. 服务器将网页数据发送给浏览器;
6. 通信完成，断开TCP连接;
7. 浏览器解析收到的数据并显示

---
# 网络命令

- **netstat**  
  - 是监控TCP/IP网络的工具。  
  - 可以显示路由表、网络连接和接口设备状态信息。  
  - 显示与IP、TCP、UDP和ICMP相关的统计数据。  
  - 一般用于检验本机各端口的网络连接情况。

- **nslookup**  
  - 监测DNS服务器是否能正确实现域名解析。  

- **ping**  
  - 常用于测试网络连通性。  
  - 可以直接ping目标地址。

- **tracert**  
  - 路由跟踪实用程序。  
  - 用于确定IP数据包访问目标所采取的路径。

- **命令与DNS关联**  
  - nslookup、ping、tracert可以加上主机域名作为参数诊断DNS故障。  
  - nslookup可以看到本地DNS服务器地址。  
  - netstat与DNS无关联。

---
# ADSL Modem 拨号方式
ADSL Modem（Asymmetric Digital Subscriber Line Modem），即非对称数字用户线路调制解调器，是一种用于通过普通电话线提供高速互联网接入的设备。它利用现有的电话铜缆基础设施，在不干扰语音通话的前提下，实现宽带数据传输。 ADSL Modem 上网拨号主要有三种方式：

| 拨号方式 | 特点 |
|----------|------|
| **专线方式（静态 IP）** | 通过固定的公网 IP 地址接入互联网，适用于需要稳定 IP 的场景。 |
| **PPPoA（Point-to-Point Protocol over ATM）** | 将 PPP 协议封装在 ATM 链路中，常用于早期 DSL 网络。 |
| **PPPoE（Point-to-Point Protocol over Ethernet）** | 将 PPP 协议封装在以太网帧中，广泛用于现代宽带接入，支持用户认证（如用户名/密码），是目前最常用的拨号方式。 |

## 常见链路层协议与隧道协议

### 1. PPP（Point-to-Point Protocol，点对点协议）
- **定位**：链路层协议。
- **用途**：用于在两个节点之间建立直接连接，支持拨号或专线方式传输数据包。
- **特点**：
  - 支持全双工通信。
  - 提供身份验证机制（PAP、CHAP）。
  - 可承载多种网络层协议（如 IPv4、IPv6）。
  - 是许多高级协议（如 PPTP、L2TP）的基础。

### 2. SLIP（Serial Line Internet Protocol，串行线路网际协议）
- **定位**：早期的串行链路协议。
- **特点**：
  - Windows 远程访问的旧工业标准。
  - 主要用于 Unix 系统远程访问。
  - 功能简单，已基本被 PPP 替代。
- **现状**：仍用于某些 ISP 或嵌入式设备中。

### 3. PPTP（Point-to-Point Tunneling Protocol，点对点隧道协议）
- **定位**：基于 PPP 的隧道协议。
- **用途**：构建虚拟专用网（VPN）。
- **特点**：
  - 在 PPP 协议基础上扩展，支持多协议。
  - 提供安全通道，支持 PAP、EAP 等认证方式。
  - 允许远程用户通过 Internet 安全地访问企业内部网络。

### 4. PPPoE（Point-to-Point Protocol over Ethernet）
- **定位**：以太网上的点对点协议。
- **用途**：广泛应用于家庭宽带、小区宽带等场景。
- **特点**：
  - 将 PPP 封装在以太网帧中。
  - 支持用户身份验证（如宽带拨号上网时输入的账号密码）。
  - 能够实现多个用户共享一条物理连接，同时保持逻辑上的点对点通信。

## 协议对比总结

| 协议 | 所属层级 | 应用场景 | 是否支持认证 | 是否仍在广泛使用 |
|------|-----------|------------|----------------|------------------|
| PPP | 链路层 | 拨号、专线、基础协议 | ✅（PAP、CHAP） | ✅ |
| SLIP | 链路层 | 早期远程访问 | ❌（无） | ❌ |
| PPTP | 隧道协议 | 构建 VPN | ✅ | ⚠️ 逐渐被替代 |
| PPPoE | 隧道协议 | 宽带拨号上网 | ✅ | ✅ |
