# TODO 待完善

## 数据库概念结构设计
1. 首先**对数据进行抽象**，以确定需要哪些数据以及它们之间的关系。
2. 然后，根据抽象出的数据，**设计局部视图**。
3. 接下来，将各个**局部视图进行合并**，并**消除其中的冲突和冗余**。
4. 最后，对合并后的数据进行**修改和重构**，以**确保数据的一致性和完整性**。


## DBMS的功能：

* 数据定义
* 数据库操作
* 数据库运行管理
* 数据组织
* 存储和管理
* 数据库的建立和维护
* 与其他软件系统的通信功能等

特征：

分类：

体系结构：

## 三级模式——两级映像

![img](https://img-blog.csdnimg.cn/20200817113042619.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzgyMzgwOA==,size_16,color_FFFFFF,t_70)

三级模式**（一个数据库系统中，外模式可以有多个，而模式和内模式只有一个！！！）**：

* 外模式：也称**用户模式或子模式**，是用户与数据库系统的接口，是用户看到的那部分数据的描述。 描述外模式的数据定义语言为：外模式DDL。(视图)
* 模式：也称**概念模式**，它是数据库中全体数据的逻辑结构和特征的描述。只涉及型的描述，不涉及具体的值。概念模式的一个具体值称为模式的一个实例，同一个模式可以有很多实例。描述模式的数据定义语言为：模式DDL。(基本表)
* 内模式：也称**存储模式**，是数据物理结构和存储方式的描述，是数据在数据库内部的表示方法，定义所有的内部记录类型、索引和文件的组织方法，以及数据控制方面的细节。描述内模式的数据定义语言为：内模式DDL。(文件)

两级映像：

数据的独立性是由DBMS的两级映像功能来保证的。

* **模式/内模式映像：**存在于概念级和内部级之间，实现了模式和内模式之间的相互转换。**保证了数据的物理独立性。**

* **外模式/模式映像：**存在于外部级和概念级之间，实现了外模式和模式之间的相互转换。**保证了数据的逻辑独立性。**

数据的独立性：

## 数据模型：

数据模型三要素：数据结构、数据操作、数据的约束条件


# 数据库设计过程阶段产物
* 需求分析:数据流图、数据字典
* 概念设计:ER模型
* 逻辑设计:关系模式、规范法理论
* 物理设计:物理特性等


# ER 图
E-R图：实体（矩形）、联系（菱形）、属性（椭圆）

## E-R 图中的冲突类型

在数据库设计过程中，当多个设计者或不同部门分别设计局部E-R图然后合并成全局E-R图时，可能会出现各种冲突。
解决这些冲突需要设计者之间充分协商，统一标准，必要时可能需要调整局部E-R图的设计。

以下是主要的E-R图冲突类型：
### 1. 属性冲突
- **属性域冲突**：同一属性在不同局部E-R图中采用不同的数据类型、取值范围或计量单位
- **属性取值单位冲突**：例如重量单位有的用公斤，有的用磅

### 2. 命名冲突
- **同名异义冲突**：不同意义的对象(属性)使用了相同的名称
- **异名同义冲突**：相同意义的对象(属性)使用了不同的名称

### 3. 结构冲突
- **同一对象在不同E-R图中的抽象不同**：在一个图中作为实体，在另一个图中作为属性
- **同一实体在不同E-R图中的属性组成不同**：包含的属性数量或种类不一致
- **实体间联系在不同E-R图中呈现不同类型**：如在一个图中是一对多联系，在另一个图中是多对多联系

### 4. 约束冲突
- 不同E-R图中对同一实体或联系的约束条件不一致，如参与度、基数约束等




## 关系代数
关系代数运算：**并，交，差，笛卡尔积，投影，选择，连接，除**

| 运算名称 | 符号 | 定义 | 示例 |
|----------|------|------|------|
| **并**   | ∪    | 合并两个相容关系，去除重复元组 | r ∪ s：将关系r和s合并，重复元组只保留一次 |
| **交**   | ∩    | 取两个关系的共同元组 | r ∩ s：仅保留同时存在于r和s中的元组 |
| **差**   | −    | 取r中不在s中的元组 | r − s：保留r有但s没有的元组 |
| **笛卡尔积** | ×    | 将两个关系的所有元组两两组合，属性列合并 | r × s：元组数为两表元组数的乘积，属性列为两表属性之和 |
| **投影** | π    | 选取特定属性列，**去除重复元组**，形成新关系 | π_姓名,年龄(学生表)：仅保留“姓名”和“年龄”两列并去重 |
| **选择** | σ | 筛选满足条件的元组 | σ_年龄>20(学生表)：筛选年龄大于20岁的记录 |
| **自然连接** | ⋈    | 自动匹配同名属性，合并相同值元组，去重属性。 | 学生表 ⋈ 课程表：默认匹配同名的学号列，结果中只保留一个学号列 |
| **θ连接** | ⋈_{θ} | 笛卡尔积后，根据条件θ筛选元组（或者 **σ_θ(r × s)**） | r ⋈_{A=B} s：合并r和s中满足A=B条件的元组 |
| **除**   | ÷    | 若s的属性是r的子集，则结果为r中与s所有元组均能组合存在的元组 | r ÷ s：保留r中非s属性且与s所有元组组合存在的部分 |

## SQL语法：

```sql
-- 数据查询
select...from...where...group by...having...order by...
-- 插入数据
insert into...values... 
-- 修改数据
update...set...=...where... 
-- 删除数据
delete from...where... 
-- 授权
grant...on...to...(with grant option) 
-- 回收权限
revoke...on...from... 
```

函数依赖:

* 完全函数依赖
* 部分函数依赖
* 平凡函数依赖
* 非平凡函数依赖
* 传递函数依赖

在数据库理论中，函数依赖（Functional Dependency, FD）是描述数据之间关系的一个重要概念，主要用于数据库的设计和规范化。以下是关于函数依赖的一些关键点：

1. **定义**：
   - 函数依赖是一个逻辑关系，它表明在一个关系模式中，如果属性集X确定了另一个属性Y，也就是说，对于X的每一个可能的值，都有唯一确定的Y的值，那么我们说Y函数依赖于X，记作`Y → X`。
   
2. **属性集与关系模式**：
   - `R(U)`表示一个关系模式，其中R是关系名，U是属性集合，例如`U = {学号, 姓名, 年龄, 专业}`。
   
3. **类型**：
   - **完全函数依赖**：如果X → Y，并且Y不能被X的任何真子集所决定，那么称Y完全函数依赖于X，记作`X →+ Y`。
   - **部分函数依赖**：如果X → Y，但Y可以被X的某个真子集Z所决定，那么称Y部分函数依赖于X，记作`X → Z`。
   - **传递函数依赖**：如果X → Y，Y → Z，那么Z传递函数依赖于X，记作`X → Z`。
   
4. **Armstrong公理及其引理**：
   
   - **Reflexivity（公理-自反律）**：若 Y⊆X⊆U，则 X→Y 被 F 逻辑蕴含。
   - **Augmentation（公理-增广律）**：若 X→Y为F所蕴涵，且 Z⊆U，则 XZ→YZ 被 F 逻辑蕴含。
   - **Transitivity（公理-传递律）**：若 X→Y， Y→Z为F所蕴涵，则 X→Z被 F 逻辑蕴含。
   
   • 根据上述3条推理规则又可推出下述3条推理规则：
   
   （1）**引理-合并律**：若 X→Y 且 X→Z，则 X→YZ为F所蕴涵。 （证明：根据增广律可以得到 X→XY， XY→YZ，再根据传递律得到，X→YZ。）
   （2）**引理-伪传递律**：若 X→Y 且 WY→Z，则 XW→Z为F所蕴涵。 （证明：证明方法依然是 增广律 和 传递律。）
   （3）**引理-分解律**：若 X→Y 且 Z⊆Y，则 X→Z为F所蕴涵。（ 证明：根据自反律可以得到 Y→Z，再根据传递律，得证 X→Z。）
   
5. **最小函数依赖集**：
   - 在设计数据库时，我们通常寻找函数依赖的最小覆盖，这意味着找到一组函数依赖，它们能够等价于原始依赖集，但没有冗余的依赖。
   
6. **规范化**：
   - 函数依赖用于指导数据库的规范化过程，以减少数据冗余和提高数据一致性。例如，通过消除部分和传递依赖，我们可以达到不同的范式，如第一范式（1NF）、第二范式（2NF）、第三范式（3NF）和更高的BCNF（Boyce-Codd范式）。

## 函数依赖的闭包F +
**定义：关系模式R(U,F)中为F所逻辑蕴含的函数依赖的全体称为F的闭包，记为：F + 。**
即在F中能看出来并且其所蕴含的所有关系的集合称为函数依赖的闭包

> 参考：https://blog.csdn.net/weixin_49765221/article/details/123511630



事务:

* 特性： ACID
* 事务管理：事务开始（begin transaction），事务提交（commit），事务回滚（rollback）

数据库故障：事务内部故障、系统故障、介质故障、计算机病毒

数据库锁、数据不一致：

数据备份与恢复：





